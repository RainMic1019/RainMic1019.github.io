(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{485:function(t,a,s){t.exports=s.p+"assets/img/shape.9bb45a82.png"},486:function(t,a){t.exports="data:image/png;base64,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"},487:function(t,a){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAAClCAYAAAC+7wThAAAIJElEQVR4Ae2d247kOBJD8/9/ugZq+AAeoMEWyxm6mQssqFyGwxLjlDzYl/n85D9JoCCBT0HPtEwCPwErEJQkELBKYk3TgBUGShIIWCWxpmnACgMlCQSskljTNGCFgZIEAlZJrGkasMJASQIBqyTWNN0WrM/n8/Ov/7bx/qum+RV1b0crYAWskr+BgBWwAtY9gVmfuN733vf6xnVurNxYJdwHrIAVsO4J9H6SZtXd9/rGdW6s3Fgl3AesgBWwShJI05IElruxZv0z0bff26bV27NkspObBqzCT2HAmkz3/fW9w1i9rp2pd4/385+yzo2VG6uE5YAVsAIWn5aWBGulM+ucd5dMdnLT3Fi5sUoQDFgBK2Dx2WtJsFY6s855d8lkJzdd7saanEde/6UElgNL3UB47eyslX4po/+1Ue/D4wF+K515FvZZoQHLTFVBgkdLfitttcrHo+cuGrDMSTFopbRUNXitlrVSeu6iAcuclBo+Hi35rbTVKh+PnrtowDInxaCV0lLV4LVa1krpuYsGLHNSavh4tOS30larfDx67qIBy5wUg1ZKS1WD12pZK6XnLhqwzEmp4ePRkt9KW63y8ei5iwYsc1IMWiktVQ1eq2WtlJ676HJg7RJc9qkTGAaW+mvEa1tlrVQfaR1XnQHvtDOTfsAiiQIFHqUB62HwKly800LmXEpPOzOY5MYiiQJVQOEFrIfBE6TS00JWZ8U77cxgkhuLJAoUeJQGrIfBq3DxTguZcyk97cxgkhuLJApUAYUXsB4GT5BKTwtZnRXvtDODybAbixdG35HAMLD4C1XaIlc+3i6jYb9KTzszswlYJFGgCii8gPUweIJUelrI6qx4p50ZTHJjkUSBAo/SgPUweBUu3mkhcy6lp50ZTHJjkUSBKqDwAtbD4AlS6Wkhq7PinXZmMMmNRRIFCjxKA9bD4FW4eKeFzLmUnnZmMBl2Y/HC6DsSCFjXnNWtgtdKWSsFHVWD5/ak9+oasK4JMWilLgSqF57bc3Wg2F/AupJg0EpdCFQvPLcng1tdA9Y1IQat1IVA9cJze64OFPsLWFcSDFqpC4Hqhef2ZHCra8C6JsSglboQqF54bs/VgWJ/AetKgkErdSFQvfDcngxudQ1Y14QYtFIXAtULz+25OlDsL2BdSTBopS4Eqhee25PBra4Ba/UJbbq/gLXp4Fbf9rZg8SlR2sJXPl5FXVXP1YFifwFrgX9JE4ArZWC7aMAKWCWsBqyAFbDuCajPBl6rZ620oq6q5z2Dlde5sXJjlfAZsAJWwLonoD5teK2etdKKuqqe9wxWXufGyo1Vwue2YJWkkaZfS2A5sNQnC6+dnrVSp+5rid4aqb3hzd7jbbtfXQas61P41VSvZsCjtJUqH69if5U9A1bAKuErYAWsgHX/LLBW2hJTPl5Jssa72YfSqj1W9c2NlRurhK2AFbACFp+KlgRrpU5dRbpqb3iz91hx7j9nqmr8274ErvTPxj+ff8Ll1P12v+o5dQa82XtU+3/iLfcpfHKYPLtOAsPA4i9UaYtF+XhO3cyo2a/SXc7i5hiw3MSMegUUXsAyAv1bKUEqdUJWffD+to+R/xv7UOqceeTen74rN9bTBMXzCii89jhrpeI1S1oBq3AsChS8gPVwAASp1AlZ9cF7uOXHj7MPpc6ZH29oYIPcWIVhK6DwAtbDARCkUidk1Qfv4ZYfP84+lDpnfryhgQ1yYxWGrYDCC1iFA0jr8xLY9sbaYRTcSkrbOZSPt8N573sMWPc0vrwGCqXtlcrH+/LWytsFrMKIgUJpwHo4ABUu3mkhcy6lp50ZTHJjkUSBKqDwAtbD4AlS6Wkhq7PinXZmMMmNRRIFCjxKA9bD4FW4eKeFzLmUnnZmMMmNRRIFqoDCC1gFwafluQnkxjJny02jlJaqBq/VslZKz100YJmTUsPHoyW/lbZa5ePRcxcNWOakGLRSWqoavFbLWik9d9GAZU5KDR+PlvxW2mqVj0fPXTRgmZNi0EppqWrwWi1rpfTcRQOWOSk1fDxa8ltpq1U+Hj130YBlTopBK6WlqsFrtayV0nMXDVjmpNTw8WjJb6WtVvl49NxFA5Y5KQatlJaqBq/VslZKz110GFi7BJJ9fieBYWCpv0a8diTWSp263pjU+/Dc9/KcUrdn73lm1wWsawJq+HguBDyn1O05G5je9wesKyk1fDwXAp5T6vbsHezsuoB1TUANH8+FgOeUuj1nA9P7/oB1JaWGj+dCwHNK3Z69g51dF7CuCajh47kQ8JxSt+dsYHrfH7CupNTw8VwIeE6p27N3sLPrAtY1ATV8PBcCnlPq9pwNTO/7A9aVlBo+ngsBzyl1e/YOdnbdMLBmHzTvH5vAcmCpv268FhFrpRV1znjU3vAq9khvpc45flMbsK5/SZMaAp4bMM8pDVhuqr+sV0PA22UY7FfpLmdxx5kbKzeWy0xXfcAKWF2guEUBK2C5zHTVB6yA1QWKWxSwApbLTFd9wApYXaC4RcuB5R4g9WsmsC1Y6v8bwmuRs1Y6ezRqb3jOWXhGafWZA9b1KawOWvVXAOAFLJXgFz0CV+oM44tbs1upM+A5Z+EZpfYmzQdyY+XGMpHpKw9YAauPFLMqYAUsE5m+8oAVsPpIMasCVsAykekrD1gBq48Us2pbsMxzpnxwAgFrcOBveV3AesukB58zYA0O/C2vC1hvmfTgcwaswYG/5XUB6y2THnzOgDU48Le8LmC9ZdKDzxmwBgf+ltcFrLdMevA5A9bgwN/yuoD1lkkPPud/g9c0NPrtEQUAAAAASUVORK5CYII="},640:function(t,a,s){"use strict";s.r(a);var e=s(2),r=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"_1-前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-前言"}},[t._v("#")]),t._v(" 1 前言")]),t._v(" "),a("p",[t._v("首先，再阅读本文之前需要对 FreeType 的使用方法有基本的了解，可以参考："),a("RouterLink",{attrs:{to:"/blog/gui/awtk_freetype_ttf.html"}},[t._v("FreeTpye库学习笔记：将矢量字体解析为位图")]),t._v("。")],1),t._v(" "),a("h2",{attrs:{id:"_2-freetype-存在的问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-freetype-存在的问题"}},[t._v("#")]),t._v(" 2 FreeType 存在的问题")]),t._v(" "),a("p",[t._v("矢量字体（TrueType）通过数学曲线来描述字形，包含字形边界上的关键点、连线的导数信息等。")]),t._v(" "),a("p",[t._v("FreeType 解析矢量字体的过程是将字形关键点按照规则连线变成字符轮廓，最后再将轮廓填充成点阵字。")]),t._v(" "),a("p",[t._v("很明显，在这个过程中，字形关键点是字体轮廓精准的度量，而位图则可以看成网格状态的，单位为像素，那么将坐标点转化为位图的过程势必会导致精度丢失，比如点坐标为(1.2, 2.8)，那么转换成位图则变成了(1, 3)。")]),t._v(" "),a("p",[t._v("并且由于 FreeType 为了提高运算速度，采用位移的方式进行数学计算势必会导致精度丢失更加严重，在处理一些小字号字体或像素字体时，容易发生像素块粘连的现象。")]),t._v(" "),a("p",[t._v("例如，像素字体的字形如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:s(485),alt:"像素字体字形"}})]),t._v(" "),a("p",[t._v("但解析后得到的位图如下，可以明显看见像素粘连：")]),t._v(" "),a("p",[a("img",{attrs:{src:s(486),alt:"解析后得到的位图"}})]),t._v(" "),a("h2",{attrs:{id:"_3-优化freetype的解析效果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-优化freetype的解析效果"}},[t._v("#")]),t._v(" 3 优化FreeType的解析效果")]),t._v(" "),a("h3",{attrs:{id:"_3-1-提高解析字体的精度"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-提高解析字体的精度"}},[t._v("#")]),t._v(" 3.1 提高解析字体的精度")]),t._v(" "),a("p",[t._v("虽然 FreeType 解析字体时精度丢失无法避免，但提高运算精度依然可以优化显示效果。")]),t._v(" "),a("p",[t._v("FreeType 提供两种计算二次贝塞尔曲线的精度，低精度 0.5 个像素，高精度 0.0625 个像素。其默认采用低精度进行运算，通过设置标志位 FT_OUTLINE_HIGH_PRECISION 可让 FreeType 采用高精度运算。")]),t._v(" "),a("div",{staticClass:"language-c extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("uint32_t")]),t._v(" flags "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" FT_LOAD_DEFAULT "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" FT_LOAD_RENDER "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" FT_LOAD_NO_AUTOHINT "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" FT_OUTLINE_HIGH_PRECISION"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h3",{attrs:{id:"_3-2-关闭-auto-hint"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-关闭-auto-hint"}},[t._v("#")]),t._v(" 3.2 关闭 auto_hint")]),t._v(" "),a("p",[t._v("要了解 auto_hint 首先需要知道什么是 hinting 。")]),t._v(" "),a("p",[t._v("hinting 用来优化字体显示的方法。由于屏幕像素有限，矢量字体的缩放需要有更多的考虑，例如当一条线在两个像素格子中间时，该取左边的格子还是右边的格子？如果这方面没做好，就常常会出现字形衬线没对齐、或小字号字形歪七扭八、或像素块粘连到一起的情况。")]),t._v(" "),a("blockquote",[a("p",[t._v("备注：hinting 是额外的信息，它告诉 渲染器 renderer 该如何处理这些细节部分，使矢量字在小字号时显示效果更好，因此，hinting 是非常费时费人力的工作，TrueType 字体很多，但是有良好 hinting 的不多，拙劣的 hinting 会让字变得很难看。")])]),t._v(" "),a("p",[t._v("为了改善以上问题，FreeType 提供了 auto_hint 功能，并默认开启该功能，它可以自动为没有 hinting 的字体做 hinting 工作，auto_hint 肯定无法做得像人力 hinting  一样好，对于许多笔画复杂的文字（如中文）效果不佳，并且对于小字号的复杂字形，经常造成一系列反效果，最典型问题的就是像素粘连。")]),t._v(" "),a("p",[t._v("因此，经过多次测试，关闭 FreeType 的 auto_hint 功能可以对大多数矢量字体的中文显示效果更好，通过设置标志位 FT_LOAD_NO_AUTOHINT 可关闭该功能。")]),t._v(" "),a("div",{staticClass:"language-c extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("uint32_t")]),t._v(" flags "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" FT_LOAD_DEFAULT "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" FT_LOAD_RENDER "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" FT_LOAD_NO_AUTOHINT "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" FT_OUTLINE_HIGH_PRECISION"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"_4-总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-总结"}},[t._v("#")]),t._v(" 4 总结")]),t._v(" "),a("p",[t._v("经过以上优化，FreeType 解析像素字体后得到的位图效果如下：")]),t._v(" "),a("p",[a("img",{attrs:{src:s(487),alt:"优化后的效果"}})]),t._v(" "),a("p",[t._v("由此可见，对于字号较小的复杂字形以及像素字体，提高 FreeType 的解析精度并关闭 auto_hint 功能能有效提高显示效果。")])])}),[],!1,null,null,null);a.default=r.exports}}]);